<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DI è—¥å¸«è¡›æ•™å–®å¼µç”Ÿæˆå™¨ (v6.0 é«˜ç²¾åº¦æ“¬çœŸç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f3f4f6; }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 5px;
        }
    </style>
</head>
<body class="p-6">

<div class="max-w-5xl mx-auto bg-white shadow-xl rounded-lg p-8">
    <div class="flex justify-between items-center mb-4">
        <h1 class="text-3xl font-bold text-blue-800">ğŸ¥ è—¥å“è¡›æ•™å–®å¼µç”Ÿæˆå™¨</h1>
        <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">v6.0 (é«˜ç²¾åº¦æ“¬çœŸç‰ˆ)</span>
    </div>
    
    <p class="text-gray-600 mb-6">ä¾æ“šé™¢å…§æ¨™æº–ç¯„æœ¬ï¼Œæ·±åº¦è§£æäº¤äº’ä½œç”¨ã€é£²é£Ÿç¦å¿Œèˆ‡å…·é«”å‰¯ä½œç”¨ã€‚</p>

    <div class="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg shadow-sm">
        <label class="block text-sm font-bold text-yellow-800 mb-2 flex justify-between">
            <span>ğŸ”‘ Google Gemini API Key</span>
            <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 underline text-xs">å–å¾—å…è²» Key</a>
        </label>
        <div class="flex gap-2">
            <div class="relative flex-grow">
                <input type="password" id="apiKey" oninput="saveApiKey()" placeholder="è²¼ä¸Šæ‚¨çš„ API Key (ä¾‹å¦‚ï¼šAIzaSy...)" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-yellow-400 outline-none pr-10">
                <button onclick="toggleKeyVisibility()" class="absolute right-2 top-2 text-gray-400 hover:text-gray-600">ğŸ‘ï¸</button>
            </div>
            <button onclick="detectModels()" id="detectBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded font-bold text-sm whitespace-nowrap shadow transition">
                ğŸ” åµæ¸¬å¯ç”¨æ¨¡å‹
            </button>
        </div>
        <p id="modelStatus" class="text-xs text-gray-500 mt-2">å»ºè­°ä½¿ç”¨ <strong>Gemini 1.5 Pro</strong> ä»¥ç²å¾—æœ€è©³ç´°çš„è¼¸å‡ºã€‚</p>
    </div>

    <div class="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg shadow-sm">
        <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ¤– AI æ¨¡å‹é¸æ“‡</label>
        <select id="aiModel" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-400 outline-none bg-white font-mono text-sm">
            <option value="gemini-1.5-flash">é è¨­ (è‹¥éœ€è¦æ›´è©³ç´°å…§å®¹å»ºè­°åˆ‡æ›è‡³ Pro)</option>
        </select>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
            <label class="block text-sm font-medium text-gray-700">æŒ‡å®šå­¸å (Generic Name)</label>
            <input type="text" id="genericName" placeholder="ä¾‹å¦‚ï¼šAmiodarone HCl" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2" value="Amiodarone HCl">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700">æŒ‡å®šå•†å“å (Brand Name)</label>
            <input type="text" id="brandName" placeholder="ä¾‹å¦‚ï¼šCordarone Tab 200 mg" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2" value="Cordarone Tab 200 mg">
        </div>
    </div>

    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">è—¥å“å»¢æ£„é¡åˆ¥</label>
        <select id="drugCategory" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm border p-2 bg-gray-50">
            <option value="general">ä¸€èˆ¬è—¥å“ (ä½¿ç”¨ H-1 éš¨åƒåœ¾ä¸Ÿæ£„)</option>
            <option value="special">ç‰¹æ®Šè—¥å“ (ä½¿ç”¨ H-2 éœ€æª¢æ”¶ï¼šæŠ—è…«ç˜¤/æŠ—ç”Ÿç´ /è·çˆ¾è’™/ç®¡åˆ¶è—¥)</option>
        </select>
    </div>

    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-1">åŸå§‹æ–‡ç»ä¾†æº (PDF è§£æ æˆ– ç›´æ¥è²¼ä¸Šæ–‡å­—)</label>
        <div class="flex items-center gap-4 mb-2">
            <label class="cursor-pointer bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200 px-4 py-2 rounded-md transition text-sm font-bold flex items-center">
                ğŸ“„ ä¸Šå‚³ PDF åŒ¯å…¥æ–‡å­—
                <input type="file" id="pdfInput" accept=".pdf" class="hidden" onchange="handlePdfUpload(this)">
            </label>
            <span id="uploadStatus" class="text-xs text-gray-500">å°šæœªä¸Šå‚³</span>
        </div>
        <textarea id="sourceText" rows="12" class="w-full rounded-md border-gray-300 shadow-sm border p-3 text-sm font-mono bg-gray-50 focus:bg-white transition" placeholder="æ‚¨å¯ä»¥ï¼š&#10;1. é»æ“Šä¸Šæ–¹æŒ‰éˆ•ä¸Šå‚³ PDFï¼Œæ–‡å­—æœƒè‡ªå‹•å‡ºç¾åœ¨é€™è£¡ã€‚&#10;2. æˆ–è€…ç›´æ¥å°‡ UpToDate/Micromedex çš„æ–‡å­—è²¼åœ¨é€™è£¡ã€‚"></textarea>
    </div>

    <button onclick="callAI()" id="generateBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded-lg transition duration-200 shadow-md text-lg flex justify-center items-center">
        é–‹å§‹ç”Ÿæˆè¡›æ•™å–®å¼µ ğŸš€
    </button>

    <div id="resultSection" class="mt-8 hidden">
        <div class="flex justify-between items-center mb-2 bg-green-50 p-2 rounded border border-green-200">
            <h3 class="text-lg font-bold text-green-800">ğŸ‰ ç”Ÿæˆçµæœ</h3>
            <button onclick="copyResult()" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm font-bold flex items-center shadow">
                ğŸ“‹ ä¸€éµè¤‡è£½
            </button>
        </div>
        <div id="aiOutput" class="bg-white border border-gray-300 p-6 rounded-lg text-gray-800 leading-relaxed whitespace-pre-wrap font-mono text-sm shadow-inner min-h-[300px]"></div>
    </div>
</div>

<script>
    const STORAGE_KEY = 'drug_info_gen_api_key';

    window.onload = function() {
        const savedKey = localStorage.getItem(STORAGE_KEY);
        if (savedKey) {
            document.getElementById('apiKey').value = savedKey;
        }
    };

    function saveApiKey() {
        const key = document.getElementById('apiKey').value.trim();
        localStorage.setItem(STORAGE_KEY, key);
    }

    function toggleKeyVisibility() {
        const input = document.getElementById('apiKey');
        input.type = input.type === "password" ? "text" : "password";
    }

    // --- è‡ªå‹•åµæ¸¬æ¨¡å‹ ---
    async function detectModels() {
        const apiKey = document.getElementById('apiKey').value.trim();
        const statusElem = document.getElementById('modelStatus');
        const selectElem = document.getElementById('aiModel');
        const btn = document.getElementById('detectBtn');

        if (!apiKey) { alert("è«‹å…ˆè¼¸å…¥ API Keyï¼"); return; }

        btn.disabled = true;
        btn.innerHTML = '<span class="loader"></span> æŸ¥è©¢ä¸­...';
        statusElem.innerHTML = "æ­£åœ¨å‘ Google æŸ¥è©¢æ‚¨çš„å¸³è™Ÿæ¬Šé™...";
        statusElem.className = "text-xs text-blue-600 mt-2 font-bold";

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`);
            const data = await response.json();

            if (data.error) throw new Error(data.error.message);

            selectElem.innerHTML = "";
            let count = 0;
            if (data.models) {
                data.models.forEach(model => {
                    if (model.supportedGenerationMethods && model.supportedGenerationMethods.includes("generateContent")) {
                        if (model.name.includes('gemini')) {
                            const shortName = model.name.replace("models/", "");
                            const option = document.createElement("option");
                            option.value = shortName;
                            option.text = `${model.displayName} (${shortName})`;
                            selectElem.appendChild(option);
                            count++;
                        }
                    }
                });
            }

            if (count > 0) {
                statusElem.innerHTML = `âœ… æˆåŠŸï¼å·²è‡ªå‹•è¼‰å…¥ ${count} å€‹å¯ç”¨æ¨¡å‹ã€‚`;
                statusElem.className = "text-xs text-green-600 mt-2 font-bold";
                selectElem.selectedIndex = 0;
            } else {
                statusElem.innerHTML = "âš ï¸ æŸ¥è©¢æˆåŠŸä½†ç„¡å¯ç”¨æ¨¡å‹ã€‚";
                statusElem.className = "text-xs text-orange-600 mt-2 font-bold";
            }
        } catch (err) {
            statusElem.innerHTML = `âŒ åµæ¸¬å¤±æ•—ï¼š${err.message}`;
            statusElem.className = "text-xs text-red-600 mt-2 font-bold";
        } finally {
            btn.disabled = false;
            btn.innerHTML = 'ğŸ” åµæ¸¬å¯ç”¨æ¨¡å‹';
        }
    }

    // --- PDF è§£æ ---
    async function handlePdfUpload(input) {
        const file = input.files[0];
        if (!file) return;
        const statusElem = document.getElementById('uploadStatus');
        const textArea = document.getElementById('sourceText');
        try {
            statusElem.innerHTML = '<span class="loader"></span> è§£æä¸­...';
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
            let fullText = "";
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                fullText += `--- Page ${i} ---\n` + textContent.items.map(item => item.str).join(' ') + "\n\n";
            }
            textArea.value = fullText;
            statusElem.innerHTML = `âœ… æˆåŠŸè¼‰å…¥ï¼š${file.name} (å…± ${pdf.numPages} é )`;
            statusElem.className = "text-xs text-green-600 font-bold";
        } catch (error) {
            statusElem.innerHTML = `âŒ è§£æå¤±æ•—ï¼š${error.message}`;
        }
    }

    // --- AI ç”Ÿæˆé‚è¼¯ (v6.0 é«˜ç²¾åº¦ Prompt) ---
    async function callAI() {
        const apiKey = document.getElementById('apiKey').value.trim();
        let modelName = document.getElementById('aiModel').value; 
        const source = document.getElementById('sourceText').value.trim();
        const generic = document.getElementById('genericName').value;
        const brand = document.getElementById('brandName').value;
        const category = document.getElementById('drugCategory').value;
        const btn = document.getElementById('generateBtn');
        const outputDiv = document.getElementById('aiOutput');
        const resultSection = document.getElementById('resultSection');

        if (!apiKey) { alert("è«‹å…ˆè¼¸å…¥ API Keyï¼"); document.getElementById('apiKey').focus(); return; }
        if (!source) { alert("å…§å®¹æ˜¯ç©ºçš„ï¼"); document.getElementById('sourceText').focus(); return; }

        btn.disabled = true;
        btn.innerHTML = `<span class="loader"></span> æ·±åº¦è§£æä¸­...`;
        resultSection.classList.remove('hidden');
        outputDiv.innerHTML = "AI æ­£åœ¨é€²è¡Œæ·±åº¦è§£æ (äº¤äº’ä½œç”¨æ¯”å°ã€å‰¯ä½œç”¨æ­¸ç´)...";
        outputDiv.scrollIntoView({ behavior: 'smooth' });

        // å»¢æ£„èªå¥
        const disposalText = category === "general" 
            ? "æœ¬è—¥ç‚ºã€Œä¸€èˆ¬è—¥å“ã€ï¼Œç›®å‰åœ‹å…§å¤šç‚ºé«˜æº«ç„šåŒ–çˆï¼Œç‡ƒç‡’å¾Œå‡å¯å°‡è—¥å“å®Œå…¨è™•ç†ä¸¦æ¸›å°‘äºŒæ¬¡ç’°å¢ƒæ±™æŸ“ï¼Œä¾è¡›ç”Ÿä¸»ç®¡æ©Ÿé—œå»ºè­°ï¸°è«‹å°‡è£¸è—¥æ”¾å…¥å¤¾éŠè¢‹æˆ–å¯å°å£çš„å¡‘è† è¢‹ï¼ŒåŒå®¶ä¸­åƒåœ¾éš¨åƒåœ¾è»Šä¸Ÿæ£„ï¼›å¤–åŒ…è£å‰‡ä¾å›æ”¶åˆ†é¡è™•ç†ã€‚"
            : "æœ¬è—¥å±¬æ–¼ç‰¹æ®Šè—¥å“ï¼ˆå¦‚å«é‡é ­é‡åŠ‘ã€æŠ—è…«ç˜¤è—¥å“ã€æŠ—ç”Ÿç´ ã€è·çˆ¾è’™è—¥å“åŠç®¡åˆ¶è—¥å“ç­‰ï¼‰ï¼Œè«‹å‹¿éš¨æ„ä¸Ÿæ£„ã€‚è«‹å°‡å‰©é¤˜è—¥å“æ‹¿å›é†«ç™‚é™¢æ‰€è—¥å±€æˆ–ç¤¾å€è—¥å±€é€²è¡Œæª¢æ”¶èˆ‡å›æ”¶è™•ç†ã€‚";

        // Prompt v6.0
        const promptText = `
ä½ æ˜¯ä¸€ä½å°ç£çš„å°ˆæ¥­è—¥ç‰©è³‡è¨Šï¼ˆDrug Information, DIï¼‰è—¥å¸«ã€‚ä½ çš„ä»»å‹™æ˜¯é–±è®€ã€åŸå§‹æ–‡ç»ã€‘ï¼Œä¸¦ç”¢å‡ºèˆ‡ã€æ¨™æº–ç¯„æœ¬ã€‘å¯†åº¦ä¸€è‡´çš„ç¹é«”ä¸­æ–‡è¡›æ•™å–®å¼µã€‚

# è¼¸å…¥è³‡æ–™
1. å­¸åï¼š${generic}
2. å•†å“åï¼š${brand}
3. åŸå§‹æ–‡ç»ï¼š
"""
${source.substring(0, 30000)}
"""

# é—œéµæŒ‡ä»¤ (Critical Instructions) - å‹™å¿…éµå®ˆ
1. **äº¤äº’ä½œç”¨ (Interactions)**ï¼š
   - ä¸è¦åªåˆ—å‡ºè—¥ç†åˆ†é¡ï¼ˆå¦‚ã€ŒæŠ—ç”Ÿç´ ã€ï¼‰ã€‚
   - **å¿…é ˆ**å¾æ–‡ç»ä¸­æ‰¾å‡ºå…·é«”çš„è—¥åæˆåˆ†ï¼Œæ ¼å¼å¦‚ï¼šã€Œåˆ†é¡ï¼ˆå¦‚ï¼šè—¥å Aã€è—¥å Bï¼‰ã€ã€‚
   - è‹¥æ–‡ç»åˆ—å‡ºäº†å…·é«”çš„è—¥åï¼ˆå¦‚ ciprofloxacin, warfarin, digoxin ç­‰ï¼‰ï¼Œè«‹å‹™å¿…ç¿»è­¯ä¸¦åˆ—å‡ºã€‚

2. **ç¨ç«‹è­¦ç¤ºæ®µè½ (Distinct Warnings)**ï¼š
   - æª¢æŸ¥æ–‡ç»æ˜¯å¦æåŠ **Grapefruit (è‘¡è„æŸš)**ã€‚è‹¥æœ‰ï¼Œå¿…é ˆå»ºç«‹ç¨ç«‹æ®µè½ï¼Œä¸¦è§£é‡‹åŸå› ï¼ˆå¦‚ï¼šæŠ‘åˆ¶ä»£è¬ã€å¢åŠ æ¿ƒåº¦ï¼‰ã€‚
   - æª¢æŸ¥æ–‡ç»æ˜¯å¦æåŠ **Sunlight/Photosensitivity (å…‰æ•æ„Ÿ)**ã€‚è‹¥æœ‰ï¼Œå¿…é ˆå»ºç«‹ç¨ç«‹æ®µè½ã€‚
   - æª¢æŸ¥æ–‡ç»æ˜¯å¦æåŠ **Lactose (ä¹³ç³–)** æˆ–å…¶ä»–é‡è¦è³¦å‹åŠ‘ã€‚è‹¥æœ‰ï¼Œå¿…é ˆå»ºç«‹ç¨ç«‹æ®µè½ã€‚

3. **å‰¯ä½œç”¨æè¿° (Side Effects)**ï¼š
   - è«‹å°‡é†«å­¸è¡“èªè½‰åŒ–ç‚ºç—…äººå¯ç†è§£çš„å…·é«”ç—‡ç‹€ã€‚
   - ä¾‹å¦‚ï¼šä¸è¦åªå¯«ã€Œé»ƒç–¸ã€ï¼Œè¦å¯«ã€Œçœ¼ç™½ã€çš®è†šè®Šé»ƒã€æ·±è‰²å°¿ã€ã€‚
   - ä¾‹å¦‚ï¼šä¸è¦åªå¯«ã€Œç”²ç‹€è…ºå•é¡Œã€ï¼Œè¦å¯«ã€Œé«”é‡æ”¹è®Šã€è„–å­è®Šç²—ã€ç•å¯’æˆ–ç•ç†±ã€ã€‚

4. **æ ¼å¼**ï¼š
   - ç›´æ¥è¼¸å‡ºå…§å®¹ï¼Œä¸è¦æœ‰ä»»ä½• Markdown æ¨™ç±¤ï¼ˆå¦‚ ###ï¼‰ã€‚
   - èªæ°£å¿…é ˆæ˜¯è¦ªåˆ‡ä½†æ¬Šå¨çš„è¡›æ•™å£å»ã€‚

# è¼¸å‡ºæ¨¡æ¿ (è«‹ç›´æ¥å¡«å¯«å…§å®¹)

[å­¸å]ï¼š ${generic}
[å•†å“å]ï¼š ${brand}
[ç”¨é€”]ï¼š (ç¿»è­¯é©æ‡‰ç—‡)

[ä½¿ç”¨æ–¹æ³•]ï¼š
(ç¿»è­¯ç”¨æ³•ï¼Œä¸¦è¨»æ˜éš¨é¤æˆ–ç©ºè…¹çš„å…·é«”æ™‚é–“è¦ç¯„ï¼Œå¦‚é£¯å‰1å°æ™‚ç­‰)
å¯¦éš›ç”¨æ³•ç”¨é‡è«‹éµé†«å›‘ä½¿ç”¨ã€‚

[å¿˜äº†ç”¨è—¥æ€éº¼è¾¦ï¼Ÿ]
(ç¿»è­¯è£œæœåŸå‰‡ï¼Œé€šå¸¸ç‚ºï¼šæƒ³èµ·æ™‚ç›¡å¿«è£œæœï¼Œè‹¥æ¥è¿‘ä¸‹æ¬¡æ™‚é–“å‰‡è·³éï¼Œä¸å¯å€é‡)

[æ³¨æ„äº‹é …]ï¼š
è‹¥æ‚¨æœ‰ä¸‹åˆ—ç‹€æ³ï¼Œä¸å¯ä½¿ç”¨æœ¬è—¥ï¼š(è©³åˆ—ç¦å¿Œç—‡ï¼Œå¦‚éæ•ã€ç‰¹å®šå¿ƒè‡Ÿå‚³å°é˜»æ»¯ç´šæ•¸ã€ä¼‘å…‹ç­‰)

è‹¥æœ‰ä¸‹åˆ—æƒ…æ³ï¼Œè«‹ç¢ºèªå·²å…ˆå‘ŠçŸ¥æ‚¨çš„é†«å¸«ï¸°(è©³åˆ—æ³¨æ„äº‹é …ï¼ŒåŒ…å«æ‡·å­•ã€æ‰‹è¡“ã€é›»è§£è³ªç•°å¸¸ã€å™¨å®˜ç–¾ç—…ç­‰)

(è‹¥æ–‡ç»æœ‰è³¦å‹åŠ‘è³‡è¨Šå¦‚ Lactoseï¼Œè«‹åœ¨æ­¤è¼¸å‡ºï¼Œå¦å‰‡ç•™ç©º)ï¼š
æœ¬è—¥å…§å«(å¡«å…¥è³¦å‹åŠ‘)ï¼Œè‹¥æ‚¨æœ‰(å¡«å…¥ç›¸é—œä¸è€ç—‡)çš„æƒ…å½¢ï¼Œè«‹å‹™å¿…å‘ŠçŸ¥ä½ çš„é†«å¸«ã€‚

è«‹æ‚¨å°‡ç›®å‰ä½¿ç”¨çš„è—¥å“ï¼ˆåŒ…æ‹¬å¸‚å”®æˆè—¥ã€å„é¡ç‡Ÿé¤Šé£Ÿå“ä»¥åŠä¸­è‰è—¥ç­‰ï¼‰å‘ŠçŸ¥é†«å¸«ã€‚å°¤å…¶æ˜¯(åˆ—å‡ºè©³ç´°äº¤äº’ä½œç”¨ï¼ŒåŒ…å«è—¥ç‰©åˆ†é¡èˆ‡æ‹¬è™Ÿå…§çš„å…·é«”æˆåˆ†å)ç­‰è—¥å“ã€‚é€™äº›è—¥ç‰©èˆ‡æœ¬è—¥ä½µç”¨æœƒäº’ç›¸å½±éŸ¿ç™‚æ•ˆæˆ–å¢åŠ å‰¯ä½œç”¨çš„åš´é‡åº¦ï¼Œè«‹å‹™å¿…å…ˆå‘ŠçŸ¥é†«å¸«ï¼Œè®“é†«å¸«ç¢ºèªè—¥å“å¦‚ä½•é–‹ç«‹ã€‚

(è‹¥éœ€è¼¸å‡ºç”Ÿæ´»è­¦ç¤ºï¼Œè«‹æ’å…¥ä¸‹æ–¹æ®µè½)ï¼š
æœ¬è—¥å¯èƒ½æœƒå¼•èµ·(å¡«å…¥ç—‡ç‹€ï¼Œå¦‚é ­æšˆ)ï¼Œåœ¨ä¸ç¢ºå®šæœ¬è—¥å°æ‚¨é€ æˆçš„å½±éŸ¿å‰ï¼Œè«‹é¿å…å¾äº‹éœ€å°ˆæ³¨åŠ›åŠå”èª¿åŠ›çš„æ´»å‹•ï¼Œä¾‹å¦‚é–‹è»Šæˆ–æ“ä½œå±éšªå™¨æ¢°ã€‚

(è‹¥æ–‡ç»æåŠè‘¡è„æŸšï¼Œè«‹æ’å…¥ä¸‹æ–¹æ®µè½)ï¼š
æœè—¥æ²»ç™‚æœŸé–“é¿å…é£²ç”¨è‘¡è„æŸšæ±æˆ–è‘¡è„æŸšã€‚å› è‘¡è„æŸšæœƒæŠ‘åˆ¶æœ¬è—¥ä»£è¬ï¼Œå°è‡´æœ¬è—¥è¡€ä¸­æ¿ƒåº¦å¤§é‡æå‡è€Œå¢åŠ å‰¯ä½œç”¨ç™¼ç”Ÿæ©Ÿç‡åŠåš´é‡åº¦ã€‚

(è‹¥æ–‡ç»æåŠå…‰æ•æ„Ÿï¼Œè«‹æ’å…¥ä¸‹æ–¹æ®µè½)ï¼š
æœ¬è—¥å¯èƒ½å¢åŠ çš®è†šå°ç´«å¤–å…‰ä¹‹æ•æ„Ÿï¨è€Œå°è‡´çš®è†šç´…è…«ç­‰åæ‡‰ï¼Œå»ºè­°æ‚¨æ–¼æœè—¥æœŸé–“åˆ°åœè—¥å¾Œæ•¸å€‹æœˆï¼Œå‹¿æ–¼é™½å…‰ä¸‹æ›æ›¬æˆ–æ›éœ²æ–¼äººå·¥ç´«å¤–å…‰ä¸‹ï¼Œä¸¦åšå¥½é˜²æ›¬æªæ–½ã€‚

(è‹¥æ–‡ç»æåŠå®šæœŸæª¢æŸ¥ï¼Œè«‹æ’å…¥ä¸‹æ–¹æ®µè½)ï¼š
ä½¿ç”¨æœ¬è—¥æ²»ç™‚æœŸé–“ï¼Œé†«å¸«æœƒå¹«æ‚¨å®‰æ’å®šæœŸæª¢æŸ¥ï¼Œå¦‚ï¸°(åˆ—å‡ºè©³ç´°æª¢æŸ¥é …ç›®)ç­‰ï¼Œè«‹å‹™å¿…åœ¨é†«å¸«ç‚ºæ‚¨å®‰æ’çš„æ™‚é–“æ¥å—æª¢æŸ¥ã€‚

[å¯èƒ½çš„å‰¯ä½œç”¨]ï¼š
å‰¯ä½œç”¨ä¸ä¸€å®šæœƒç™¼ç”Ÿï¼Œä½†ä»æé†’æ‚¨æ³¨æ„ï¸°

ä¸‹åˆ—ç‚ºè¼ƒå¸¸ç™¼ç”Ÿä½†è¼ƒä¸åš´é‡çš„å‰¯ä½œç”¨ï¼Œè‹¥ç™¼ç”Ÿï¼Œè«‹æ–¼å›è¨ºæ™‚å‘ŠçŸ¥é†«å¸«ï¼›ä½†è‹¥ç—‡ç‹€æŒçºŒã€åŠ é‡ï¼Œæˆ–å·²é€ æˆæ‚¨çš„å›°æ“¾ï¼Œè«‹æå‰å›è¨ºå‘ŠçŸ¥é†«å¸«ï¼š
(åˆ—å‡ºå¸¸è¦‹å‰¯ä½œç”¨ï¼Œæè¿°è¦å…·é«”)

è‹¥æ‚¨æ–¼æœè—¥æœŸé–“ï¼Œç™¼ç”Ÿä¸‹åˆ—ç½•è¦‹ä½†è¼ƒåš´é‡çš„å‰¯ä½œç”¨ï¼Œè«‹ç›¡å¿«å°±é†«ï¼š
(åˆ—å‡ºåš´é‡å‰¯ä½œç”¨ï¼Œæè¿°è¦å…·é«”ï¼Œå¦‚éæ•ç—‡ç‹€ã€ç¥ç¶“ç—‡ç‹€ã€å‡ºè¡€å¾µå…†ç­‰)

å¦‚æœæ‚¨ç™¼ç¾ä¸Šè¿°æœªæåŠä¹‹å‰¯ä½œç”¨ï¼Œä¸”èªç‚ºå¯èƒ½æ˜¯æœ¬è—¥æ‰€é€ æˆï¼Œè«‹æ–¼å›è¨ºæ™‚å‘ŠçŸ¥é†«å¸«ã€‚

[ä¿å­˜æ–¹æ³•]ï¼š
(ç¿»è­¯ä¿å­˜æ¢ä»¶)

è«‹å°‡è—¥å“æ”¾ç½®æ–¼å…’ç«¥ç„¡æ³•è§¸åŠè™•ï¼Œä»¥å…é€ æˆèª¤æœã€‚
è«‹å‹¿å°‡è—¥å“æä¾›çµ¦ä»–äººä½¿ç”¨ã€‚
è«‹æ–¼é†«å›‘æ²»ç™‚æœŸé–“ä½¿ç”¨è—¥å“ï¼Œå‹¿ä½¿ç”¨éæœŸè—¥å“ã€‚

${disposalText}
`;

        try {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`;
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: promptText }] }] })
            });

            const data = await response.json();
            if (data.error) throw new Error(data.error.message);
            
            outputDiv.textContent = data.candidates[0].content.parts[0].text;

        } catch (err) {
            outputDiv.innerHTML = `<span class="text-red-600 font-bold">âŒ ç”Ÿæˆå¤±æ•—ï¼š${err.message}</span>`;
        } finally {
            btn.disabled = false;
            btn.innerHTML = 'é‡æ–°ç”Ÿæˆ ğŸš€';
        }
    }

    function copyResult() {
        const text = document.getElementById('aiOutput').textContent;
        navigator.clipboard.writeText(text).then(() => { alert("âœ… å…§å®¹å·²è¤‡è£½ï¼"); });
    }
</script>

</body>
</html>
